(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{148:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(16),r=a.n(c),s=(a(92),a(26)),o=a(46),i=a(158),l=a(82),d=a(11),j=(a(98),a(161)),u=a(2);var b=function(e){var t=e.variant,a=e.children;return Object(u.jsx)(j.a,{variant:t,children:a})},h=a(153),p=a(154),O=a(80);var x=function(e){var t=e.children;return Object(u.jsx)(h.a,{children:Object(u.jsx)(p.a,{className:"justify-content-md-center",children:Object(u.jsx)(O.a,{xs:12,md:12,children:t})})})},g=a(155);var f=function(){return Object(u.jsx)(g.a,{animation:"grow",role:"status",style:{height:"100px",width:"100px",margin:"auto",display:"block"},children:Object(u.jsx)("span",{className:"sr-only",children:"Cargando..."})})},m=a(19),v=a.n(m),E=a(32),T="USER_LOGIN_REQUEST",C="USER_LOGIN_SUCCESS",S="USER_LOGIN_FAILURE",I="USER_LOGOUT_SUCCESS",y=a(29),_=a.n(y),k=a(36),L=a.n(k);var w=function(e){Object(o.a)(e);var t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],r=a[1],j=Object(n.useState)(""),h=Object(s.a)(j,2),p=h[0],O=h[1],x=Object(d.b)(),g=Object(d.c)((function(e){return e.userLogin})),m=g.user,I=g.isFetching,y=g.errorMessage;return Object(n.useEffect)((function(){m&&(window.location.href="tickets")}),[m]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"sidenav",children:Object(u.jsxs)("div",{className:"login-main-text",children:[Object(u.jsx)("h2",{children:"Sistema Gestion de tickets"}),Object(u.jsx)("p",{children:"Accede a la plataforma con tus credenciales."})]})}),Object(u.jsx)("div",{className:"main",children:Object(u.jsx)("div",{className:"col-md-6 col-sm-12",children:Object(u.jsxs)("div",{className:"login-form",children:[I&&Object(u.jsx)(f,{}),y&&Object(u.jsx)(b,{variant:"danger",children:y}),Object(u.jsxs)(i.a,{onSubmit:function(e){e.preventDefault(),0!==c.length&&0!==p.length?x(function(e,t){return function(){var a=Object(E.a)(v.a.mark((function a(n){var c,r,s;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n({type:T}),c={headers:{"Content-type":"application/json"}},a.next=5,_.a.post("/api/users/login/",{username:e,password:t},c);case 5:r=a.sent,s=r.data,n({type:C,payload:s}),console.log(s),localStorage.setItem("user",JSON.stringify(s)),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(0),n({type:S,payload:a.t0.response&&a.t0.response.data.detail?a.t0.response.data.detail:a.t0.message});case 15:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e){return a.apply(this,arguments)}}()}(c,p)):L.a.fire({icon:"warning",title:"Todos los campos son obligatorios!"})},children:[Object(u.jsxs)(i.a.Group,{controlId:"username",children:[Object(u.jsx)(i.a.Label,{children:"Nombre de usuario"}),Object(u.jsx)(i.a.Control,{type:"text",placeholder:"Ingrese su nombre de usuario",value:c,onChange:function(e){return r(e.target.value)}})]}),Object(u.jsxs)(i.a.Group,{controlId:"password",children:[Object(u.jsx)(i.a.Label,{children:"Password"}),Object(u.jsx)(i.a.Control,{type:"password",placeholder:"Ingrese su password",value:p,onChange:function(e){return O(e.target.value)}})]}),Object(u.jsx)(l.a,{type:"submit",variant:"dark btn-block",children:"Iniciar sesion"})]})]})})})]})},R=a(27),A=a(7);var U=a(163),N=a(156),F=a(37),K=a(159),B=a(160),D=a(157);var G=function(){var e=Object(d.c)((function(e){return e.userLogin})).user,t=Object(d.b)();return Object(n.useEffect)((function(){e||(window.location.href="/")}),[e]),Object(u.jsx)("header",{children:Object(u.jsx)(K.a,{bg:"dark",variant:"dark",collapseOnSelect:!0,expand:"lg",children:Object(u.jsxs)(h.a,{children:[Object(u.jsx)(F.LinkContainer,{to:"/",children:Object(u.jsx)(K.a.Brand,{children:"Sistema gestion de tickets"})}),Object(u.jsx)(K.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(u.jsx)(K.a.Collapse,{id:"basic-navbar-nav",children:Object(u.jsx)(B.a,{className:"mr-auto",children:e?Object(u.jsxs)(D.a,{title:e.username,id:"username",children:[Object(u.jsx)(F.LinkContainer,{to:"/",children:Object(u.jsx)(D.a.Item,{children:"Inicio"})}),Object(u.jsx)(D.a.Item,{onClick:function(){t(function(e){return function(t){try{var a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(e.token)}};_.a.post("/api/users/logout/",e,a),localStorage.removeItem("user"),t({type:I})}catch(n){console.log(n)}}}(e))},children:"Logout"})]}):Object(u.jsx)(F.LinkContainer,{to:"/login",children:Object(u.jsxs)(B.a.Link,{children:[Object(u.jsx)("i",{className:"fas fa-user"})," Login"]})})})})]})})})},M={TICKET_LIST_REQUEST:"TICKET_LIST_REQUEST",TICKET_LIST_SUCCESS:"TICKET_LIST_SUCCESS",TICKET_LIST_FAILURE:"TICKET_LIST_FAILURE",TICKET_CREATE_REQUEST:"TICKET_CREATE_REQUEST",TICKET_CREATE_SUCCESS:"TICKET_CREATE_SUCCESS",TICKET_CREATE_FAILURE:"TICKET_CREATE_FAILURE"},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(){var t=Object(E.a)(v.a.mark((function t(a,n){var c,r,s,o,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c=n(),r=c.userLogin.user,a({type:M.TICKET_LIST_REQUEST}),s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(r.token)}},t.next=6,_.a.get("/api/tickets/list/".concat(e),s);case 6:o=t.sent,i=o.data,a({type:M.TICKET_LIST_SUCCESS,payload:i}),console.log(i),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),a({type:M.TICKET_LIST_FAILURE,payload:t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message});case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,a){return t.apply(this,arguments)}}()},Y=a(53),P=a.n(Y),z=a(87),J=a(162);var H=function(e){var t=e.pages,a=e.page,n=e.search,c=void 0===n?"":n;return c.includes("?search=")&&(c=c.split("?search=")[1].split("&")[0]),console.log(t),t>1&&Object(u.jsx)(J.a,{children:Object(z.a)(Array(t).keys()).map((function(e){return Object(u.jsx)(F.LinkContainer,{to:"?search=".concat(c,"&page=").concat(e+1),children:Object(u.jsx)(J.a.Item,{active:e+1===a,children:e+1})},e+1)}))})};var W=function(e){var t=e.history,a=Object(d.c)((function(e){return e.userLogin})).user,c=Object(n.useState)(""),r=Object(s.a)(c,2),o=r[0],i=r[1],j=Object(d.b)(),b="?search=",x=Object(d.c)((function(e){return e.ticketList})),g=x.tickets,f=x.page,m=x.pages,v=(x.error,x.loading,t.location.search);return Object(n.useEffect)((function(){a?j(Q(""!==o?b+o:v)):window.location.href="/"}),[j,t,a,o,v]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(G,{}),Object(u.jsxs)(h.a,{fluid:!0,children:[Object(u.jsx)(p.a,{className:"mt-3",children:Object(u.jsx)(O.a,{children:Object(u.jsx)(U.a,{children:Object(u.jsx)(U.a.Header,{children:Object(u.jsxs)(p.a,{children:[Object(u.jsx)("h3",{children:"Filtros"}),Object(u.jsx)(O.a,{md:6,children:Object(u.jsx)("input",{type:"text",className:"form-control",placeholder:"Buscar...",value:o,onChange:function(e){e.preventDefault(),i(e.target.value),console.log(g),""===!e.target.value&&j(Q(b+o))}})}),Object(u.jsx)(O.a,{md:3,children:a&&a.is_superuser?Object(u.jsx)(R.Link,{to:"tickets/nuevo",children:Object(u.jsx)(l.a,{variant:"success",title:"Nuevo ticket",children:Object(u.jsx)("i",{className:"fas fa-plus"})})}):null})]})})})})}),Object(u.jsx)(p.a,{className:"mt-3",children:Object(u.jsx)(O.a,{md:3,children:Object(u.jsx)(H,{page:f,pages:m,search:v})})}),Object(u.jsx)(p.a,{className:" mb-3",children:g.length>0&&g.map((function(e){return Object(u.jsx)(O.a,{md:6,children:Object(u.jsxs)(U.a,{className:"mt-3 mb-3 h-100",children:[Object(u.jsxs)(U.a.Header,{className:" bg-dark text-light text-center",children:["ID:"," ",Object(u.jsx)(N.a,{pill:!0,variant:"secondary",children:e.id})," ","/ Proyecto: ",e.proyecto]}),Object(u.jsxs)(U.a.Body,{children:[Object(u.jsxs)(p.a,{children:[Object(u.jsx)(O.a,{md:3,children:Object(u.jsx)(U.a.Title,{children:e.titulo})}),Object(u.jsx)(O.a,{md:9,children:Object(u.jsx)(N.a,{pill:!0,variant:"info",children:e.estado})})]}),Object(u.jsx)("hr",{}),Object(u.jsx)(U.a.Text,{className:"bg-light",children:e.descripcion})]}),Object(u.jsx)(U.a.Footer,{children:Object(u.jsxs)(p.a,{children:[Object(u.jsx)(O.a,{md:6,children:Object(u.jsxs)("small",{className:"text-muted",children:["Creado:"," ",P()(e.fecha_creacion).locale("es-es").format(" D / MMMM / YYYY")]})}),Object(u.jsx)(O.a,{md:6,children:Object(u.jsxs)(l.a,{variant:"primary btn-sm",disabled:!0,children:["Gestionar...en desarrollo"," "]})})]})})]})},e.id)}))})]})]})},q=a(54),V=a(43),X=a(81),Z=a(63);var $=function(e){Object(o.a)(e);var t=Object(n.useState)(Date.now()),a=Object(s.a)(t,2),c=a[0],r=a[1],p=Object(n.useState)([]),O=Object(s.a)(p,2),g=(O[0],O[1]),m=Object(n.useState)({titulo:"",descripcion:"",estado:""}),T=Object(s.a)(m,2),C=T[0],S=T[1],I=C.titulo,y=C.descripcion,k=Object(d.b)(),w=Object(d.c)((function(e){return e.userLogin})),R=Object(d.c)((function(e){return e.ticketCreate})),A=R.loading,U=R.error,N=w.user,F=function(){var e=Object(E.a)(v.a.mark((function e(){var t,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(N.token)}},e.next=3,_.a.get("/api/tickets/proyectos/",t);case 3:return a=e.sent,g(a.data),e.abrupt("return",a.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(e){S(Object(V.a)(Object(V.a)({},C),{},Object(q.a)({},e.target.name,e.target.value)))};return Object(n.useEffect)((function(){if(N){F();var e=setInterval((function(){return r(P()().utcOffset("+05:30").format("DD-MM-YYYY hh:mm:ss a"))}),1e3);return function(){clearInterval(e)}}window.location.href="/"}),[N]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(G,{}),Object(u.jsx)(h.a,{className:"mt-3",children:null!=N&&N.is_superuser?Object(u.jsxs)(u.Fragment,{children:[A&&Object(u.jsx)(f,{}),Object(u.jsxs)(x,{children:[U&&Object(u.jsx)(b,{variant:"danger",children:U}),Object(u.jsxs)(i.a,{onSubmit:function(e){e.preventDefault(),0!==C.descripcion.length&&0!==C.titulo.length?L.a.fire({title:"Confirmacion",text:"Crear ticket para el proyecto!"+C.proyecto_id,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, crear ticket"}).then((function(e){if(e.isConfirmed)return console.log(C),k(function(e,t){return function(){var t=Object(E.a)(v.a.mark((function t(a,n){var c,r,s,o,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:M.TICKET_CREATE_REQUEST}),c=n(),r=c.userLogin.user,s={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(r.token)}},t.next=6,_.a.post("/api/tickets/add/",e,s);case 6:o=t.sent,i=o.data,a({type:M.TICKET_CREATE_SUCCESS,payload:i}),console.log(i),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0),a({type:M.TICKET_CREATE_FAILURE,payload:t.t0.response&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message});case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,a){return t.apply(this,arguments)}}()}(C)),L.a.fire("Ticket generado con exito!","Tau ticket se a generado con exito, pronto lo gestionaremos","success"),void(window.location.href="/tickets")})):L.a.fire({icon:"warning",title:"Todos los campos son obligatorios!"})},children:[Object(u.jsxs)(i.a.Group,{controlId:"titulo",children:[Object(u.jsx)(i.a.Label,{children:"Titulo"}),Object(u.jsx)(i.a.Control,{type:"text",placeholder:"Titulo",value:I,name:"titulo",onChange:K})]}),Object(u.jsxs)(X.a,{controlId:"estado",children:[Object(u.jsx)(i.a.Label,{children:"Estado"}),Object(u.jsx)(Z.a,{options:[{value:"Abierto",label:"Abierto"},{value:"Pendiente",label:"Pendiente"},{value:"En proceso",label:"En proceso"},{value:"Resuelto",label:"Resuelto"},{value:"Cerrado",label:"Cerrado"}],placeholder:"Estado",name:"estado",onChange:function(e){return S(Object(V.a)(Object(V.a)({},C),{},{estado:e.value}))}})]}),Object(u.jsxs)(i.a.Group,{controlId:"descripcion",children:[Object(u.jsx)(i.a.Label,{children:"Descripcion"}),Object(u.jsx)("textarea",{rows:"5",cols:"50",name:"descripcion",className:"form-control textarea",placeholder:"Detalle situacion del ticket",value:y,onChange:K})]}),Object(u.jsxs)(i.a.Group,{controlId:"fechaCreacion",children:[Object(u.jsx)(i.a.Label,{children:"Fecha de creacion"}),Object(u.jsx)(i.a.Control,{type:"text",placeholder:c,value:c,disabled:!0})]}),Object(u.jsx)(l.a,{type:"submit",variant:"dark btn-block",children:"Crear"})]})]})]}):Object(u.jsx)(j.a,{variant:"danger",children:"No tienes permisos para acceder a esta seccion"})})]})};var ee=function(){return Object(u.jsxs)(R.BrowserRouter,{children:[Object(u.jsxs)(h.a,{children:[Object(u.jsx)(A.d,{path:"/",component:w,exact:!0}),Object(u.jsx)(A.d,{path:"/login",component:w,exact:!0})]}),Object(u.jsx)(A.d,{path:"/tickets/nuevo",component:$,exact:!0}),Object(u.jsx)(A.d,{path:"/tickets",component:W,exact:!0})]})},te=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,164)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),n(e),c(e),r(e),s(e)}))},ae=a(42),ne=a(86),ce=a(85),re=Object(ae.combineReducers)({userLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return{isFetching:!0,isAuthenticated:!1};case C:return{isFetching:!1,isAuthenticated:!0,user:t.payload,errorMessage:""};case S:return{isFetching:!1,isAuthenticated:!1,errorMessage:t.payload};case I:return{isFetching:!1,isAuthenticated:!1};default:return e}},ticketList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{tickets:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M.TICKET_LIST_REQUEST:return{loading:!0,tickets:[]};case M.TICKET_LIST_SUCCESS:return{loading:!1,tickets:t.payload.results,page:t.payload.current,pages:t.payload.num_pages};case M.TICKET_DETAIL_FAILURE:return{loading:!1,error:t.payload};default:return e}},ticketCreate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M.TICKET_CREATE_REQUEST:return{loading:!0};case M.TICKET_CREATE_SUCCESS:return{loading:!1,ticket:t.payload};case M.TICKET_CREATE_FAILURE:return{loading:!1,error:t.payload};default:return e}}}),se={userLogin:{user:localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null}},oe=[ne.a],ie=Object(ae.createStore)(re,se,Object(ce.composeWithDevTools)(ae.applyMiddleware.apply(void 0,oe)));r.a.render(Object(u.jsx)(d.a,{store:ie,children:Object(u.jsx)(ee,{})}),document.getElementById("root")),te()},92:function(e,t,a){},98:function(e,t,a){}},[[148,1,2]]]);
//# sourceMappingURL=main.d8a52887.chunk.js.map